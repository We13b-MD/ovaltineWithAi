<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="generator" content="Google Web Designer 16.4.0.0711">
  <meta name="template" content="Banner 3.0.0">
  <meta name="environment" content="gwd-dv360">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="gwdpage_style.css" rel="stylesheet" data-version="13" data-exports-type="gwd-page">
  <link href="gwdpagedeck_style.css" rel="stylesheet" data-version="14" data-exports-type="gwd-pagedeck">
  <link href="gwdgooglead_style.css" rel="stylesheet" data-version="9" data-exports-type="gwd-google-ad">
  <link href="gwdimage_style.css" rel="stylesheet" data-version="17" data-exports-type="gwd-image">
  <link href="gwdtaparea_style.css" rel="stylesheet" data-version="7" data-exports-type="gwd-taparea">
  <style id="gwd-lightbox-style">
    .gwd-lightbox {
      overflow: hidden;
    }
  </style>
  <style id="gwd-text-style">
    p {
      margin: 0px;
    }
    h1 {
      margin: 0px;
    }
    h2 {
      margin: 0px;
    }
    h3 {
      margin: 0px;
    }
  </style>
  <style>
    html, body {
      width: 100%;
      height: 100%;
      margin: 0px;
    }
    .gwd-page-container {
      position: relative;
      width: 100%;
      height: 100%;
    }
    .gwd-page-content {
      background-color: transparent;
      transform: perspective(1400px) matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
      position: absolute;
      transform-style: preserve-3d;
    }
    .gwd-page-content * {
      transform-style: preserve-3d;
    }
    .gwd-page-wrapper {
      background-color: rgb(255, 255, 255);
      position: absolute;
      transform: translateZ(0px);
    }
    .gwd-page-size {
      width: 300px;
      height: 250px;
    }
    @keyframes gwd-gen-1p20gwdanimation_gwd-keyframes {
      0% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      50% {
        transform: scale3d(1.1, 1.1, 1.1);
        animation-timing-function: linear;
      }
      100% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
    }
    #page1.gwd-play-animation .gwd-gen-1p20gwdanimation {
      animation: 2s linear 0s infinite normal forwards running gwd-gen-1p20gwdanimation_gwd-keyframes;
    }
    .gwd-image-15fk {
      position: absolute;
      top: 0px;
      left: 0px;
    }
    .gwd-image-iore {
      width: 300px;
      height: 250px;
    }
    .gwd-image-1ben {
      position: absolute;
      left: 76px;
      top: 62px;
      transform: scale3d(1, 1, 1);
    }
    .gwd-image-2zt3 {
      width: 146px;
      height: 18.76px;
    }
    @keyframes gwd-gen-j0wlgwdanimation_gwd-keyframes {
      0% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      9.0909% {
        transform: scale3d(1.1, 1.1, 1.1);
        animation-timing-function: linear;
      }
      18.1818% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      100% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
    }
    #page1.gwd-play-animation .gwd-gen-j0wlgwdanimation {
      animation: 5.5s linear 0s infinite normal forwards running gwd-gen-j0wlgwdanimation_gwd-keyframes;
    }
    @keyframes gwd-gen-zfk3gwdanimation_gwd-keyframes {
      0% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      21.4286% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      28.5714% {
        transform: scale3d(1.1, 1.1, 1.1);
        animation-timing-function: linear;
      }
      35.7143% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      100% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
    }
    #page1.gwd-play-animation .gwd-gen-zfk3gwdanimation {
      animation: 7s linear 0s infinite normal forwards running gwd-gen-zfk3gwdanimation_gwd-keyframes;
    }
    @keyframes gwd-gen-tl6igwdanimation_gwd-keyframes {
      0% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      35.2941% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      41.1765% {
        transform: scale3d(1.1, 1.1, 1.1);
        animation-timing-function: linear;
      }
      47.0588% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      100% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
    }
    #page1.gwd-play-animation .gwd-gen-tl6igwdanimation {
      animation: 8.5s linear 0s infinite normal forwards running gwd-gen-tl6igwdanimation_gwd-keyframes;
    }
    @keyframes gwd-gen-1bw2gwdanimation_gwd-keyframes {
      0% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      45% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      50% {
        transform: scale3d(1.1, 1.1, 1.1);
        animation-timing-function: linear;
      }
      55% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
      100% {
        transform: scale3d(1, 1, 1);
        animation-timing-function: linear;
      }
    }
    #page1.gwd-play-animation .gwd-gen-1bw2gwdanimation {
      animation: 10s linear 0s infinite normal forwards running gwd-gen-1bw2gwdanimation_gwd-keyframes;
    }
    .gwd-image-136o {
      position: absolute;
      left: 21px;
      top: 80px;
    }
    .gwd-image-1uxm {
      width: 52px;
      height: 90.21px;
      transform: scale3d(1, 1, 1);
    }
    .gwd-image-1e91 {
      position: absolute;
      top: 102px;
      left: 93px;
      transform: scale3d(1, 1, 1);
    }
    .gwd-image-16cs {
      width: 53px;
      height: 84.15px;
    }
    .gwd-image-1yzs {
      position: absolute;
      left: 158px;
      top: 107px;
      transform: scale3d(1, 1, 1);
    }
    .gwd-image-1h2g {
      width: 49px;
      height: 77.4px;
    }
    .gwd-image-1cg2 {
      position: absolute;
      top: 103px;
      left: 224px;
      transform: scale3d(1, 1, 1);
    }
    .gwd-image-13ae {
      width: 49px;
      height: 81.2px;
    }
    .gwd-image-19u6 {
      border-image-source: none;
      border-image-width: 1;
      border-image-outset: 0;
      border-image-repeat: stretch;
      border-color: rgb(243, 147, 11);
      background-image: none;
      background-color: rgb(215, 29, 7);
    }
    .gwd-taparea-1wqg {
      position: absolute;
      width: 49px;
      transform-origin: 50% 50% 0px;
      left: 24px;
      top: 94px;
      height: 65px;
    }
    .gwd-taparea-1v0y {
      position: absolute;
      width: 43px;
      height: 56px;
      transform-origin: 50% 50% 0px;
      left: 97px;
      top: 103px;
    }
    .gwd-taparea-iwnf {
      position: absolute;
      transform-origin: 50% 50% 0px;
      width: 43px;
      left: 168px;
      top: 107px;
      height: 58px;
    }
    .gwd-taparea-1oh7 {
      position: absolute;
      width: 39px;
      height: 56px;
      transform-origin: 50% 50% 0px;
      left: 231px;
      top: 106px;
    }
  </style>
  <script data-source="gwd_webcomponents_v1_min.js" data-version="2" data-exports-type="gwd_webcomponents_v1" src="gwd_webcomponents_v1_min.js"></script>
  <script data-source="gwdpage_min.js" data-version="13" data-exports-type="gwd-page" src="gwdpage_min.js"></script>
  <script data-source="gwdpagedeck_min.js" data-version="14" data-exports-type="gwd-pagedeck" src="gwdpagedeck_min.js"></script>
  <script data-source="https://s0.2mdn.net/ads/studio/Enabler.js" data-exports-type="gwd-google-ad" src="https://s0.2mdn.net/ads/studio/Enabler.js"></script>
  <script data-source="gwdgooglead_min.js" data-version="9" data-exports-type="gwd-google-ad" src="gwdgooglead_min.js"></script>
  <script data-source="gwdimage_min.js" data-version="17" data-exports-type="gwd-image" src="gwdimage_min.js"></script>
  <script data-source="gwdtaparea_min.js" data-version="7" data-exports-type="gwd-taparea" src="gwdtaparea_min.js"></script>
  <script type="text/javascript" gwd-events="support" src="gwd-events-support.1.0.js"></script>
  <script type="text/javascript" gwd-events="handlers">
    gwd.auto_Gwd_taparea_1Action = function(event) {
      // GWD Predefined Function
      gwd.actions.gwdPagedeck.goToPage('pagedeck', 'page1_1', 'none', 1000, 'linear', 'top');
    };
    gwd.auto_Gwd_taparea_2Action = function(event) {
      // GWD Predefined Function
      gwd.actions.gwdPagedeck.goToPage('pagedeck', 'page1_2', 'none', 1000, 'linear', 'top');
    };
    gwd.auto_Gwd_taparea_3Action = function(event) {
      // GWD Predefined Function
      gwd.actions.gwdPagedeck.goToPage('pagedeck', 'page1_3', 'none', 1000, 'linear', 'top');
    };
    gwd.auto_Gwd_taparea_4Action = function(event) {
      // GWD Predefined Function
      gwd.actions.gwdPagedeck.goToPage('pagedeck', 'page1_4', 'none', 1000, 'linear', 'top');
    };
  </script>
  <script type="text/javascript" gwd-events="registration">
    // Support code for event handling in Google Web Designer
    // This script block is auto-generated. Please do not edit!
    gwd.actions.events.registerEventHandlers = function(event) {
      gwd.actions.events.addHandler('gwd-taparea_1', 'action', gwd.auto_Gwd_taparea_1Action, false);
      gwd.actions.events.addHandler('gwd-taparea_2', 'action', gwd.auto_Gwd_taparea_2Action, false);
      gwd.actions.events.addHandler('gwd-taparea_3', 'action', gwd.auto_Gwd_taparea_3Action, false);
      gwd.actions.events.addHandler('gwd-taparea_4', 'action', gwd.auto_Gwd_taparea_4Action, false);
    };
    gwd.actions.events.deregisterEventHandlers = function(event) {
      gwd.actions.events.removeHandler('gwd-taparea_1', 'action', gwd.auto_Gwd_taparea_1Action, false);
      gwd.actions.events.removeHandler('gwd-taparea_2', 'action', gwd.auto_Gwd_taparea_2Action, false);
      gwd.actions.events.removeHandler('gwd-taparea_3', 'action', gwd.auto_Gwd_taparea_3Action, false);
      gwd.actions.events.removeHandler('gwd-taparea_4', 'action', gwd.auto_Gwd_taparea_4Action, false);
    };
    document.addEventListener("DOMContentLoaded", gwd.actions.events.registerEventHandlers);
    document.addEventListener("unload", gwd.actions.events.deregisterEventHandlers);
  </script>
</head>

<body>
  <gwd-google-ad id="gwd-ad" polite-load="">
    <gwd-metric-configuration>
      <gwd-metric-event source="gwd-taparea_1" event="tapareaexit" metric="" exit="Exit"></gwd-metric-event>
      <gwd-metric-event source="gwd-taparea_2" event="tapareaexit" metric="" exit="Exit"></gwd-metric-event>
      <gwd-metric-event source="gwd-taparea_3" event="tapareaexit" metric="" exit="Exit"></gwd-metric-event>
      <gwd-metric-event source="gwd-taparea_4" event="tapareaexit" metric="" exit="Exit"></gwd-metric-event>
    </gwd-metric-configuration>
    <gwd-pagedeck class="gwd-page-container" id="pagedeck">
      <gwd-page id="page1" class="gwd-page-wrapper gwd-page-size gwd-lightbox" data-gwd-width="300px" data-gwd-height="250px">
        <div class="gwd-page-content gwd-page-size">
          <gwd-image source="assets/Background (1)_1.jpg" scaling="stretch" id="gwd-image_4" class="gwd-image-15fk gwd-image-iore"></gwd-image>
          <gwd-image source="assets/Select a product.png" scaling="stretch" id="Select_a_product" class="gwd-gen-1p20gwdanimation gwd-image-1ben gwd-image-2zt3"></gwd-image>
          <gwd-image source="assets/Ovaltine 1.2Kg1.png" scaling="stretch" id="gwd-image_5" class="gwd-gen-j0wlgwdanimation gwd-image-136o gwd-image-1uxm"></gwd-image>
          <gwd-image source="assets/Ovaltine 18g1.png" scaling="stretch" id="Ovaltine_18g1" class="gwd-gen-zfk3gwdanimation gwd-image-1e91 gwd-image-16cs"></gwd-image>
          <gwd-image source="assets/3in1 Ovaltine 27G1.png" scaling="stretch" id="3in1_Ovaltine_27G1" class="gwd-gen-tl6igwdanimation gwd-image-1yzs gwd-image-1h2g"></gwd-image>
          <gwd-image source="assets/Ovaltine 800g1.png" scaling="stretch" id="Ovaltine_800g1" class="gwd-gen-1bw2gwdanimation gwd-image-1cg2 gwd-image-13ae"></gwd-image>
          <gwd-taparea id="gwd-taparea_1" class="gwd-taparea-1wqg"></gwd-taparea>
          <gwd-taparea id="gwd-taparea_2" class="gwd-taparea-1v0y"></gwd-taparea>
          <gwd-taparea id="gwd-taparea_3" class="gwd-taparea-iwnf"></gwd-taparea>
          <gwd-taparea id="gwd-taparea_4" class="gwd-taparea-1oh7"></gwd-taparea>
        </div>
      </gwd-page>
      <gwd-page id="page1_1" class="gwd-page-wrapper gwd-page-size gwd-lightbox" data-gwd-width="300px" data-gwd-height="250px">
        <div class="gwd-page-content gwd-page-size">
          <gwd-image source="assets/Background (1)_1.jpg" scaling="stretch" id="gwd-image_6" class="gwd-image-15fk gwd-image-iore"></gwd-image>
        </div>
      </gwd-page>
      <gwd-page id="page1_2" class="gwd-page-wrapper gwd-page-size gwd-lightbox" data-gwd-width="300px" data-gwd-height="250px">
        <div class="gwd-page-content gwd-page-size">
          <gwd-image source="assets/Background (1)_1.jpg" scaling="stretch" id="gwd-image_8" class="gwd-image-15fk gwd-image-iore"></gwd-image>
        </div>
      </gwd-page>
      <gwd-page id="page1_3" class="gwd-page-wrapper gwd-page-size gwd-lightbox" data-gwd-width="300px" data-gwd-height="250px">
        <div class="gwd-page-content gwd-page-size">
          <gwd-image source="assets/Background (1)_1.jpg" scaling="stretch" id="gwd-image_10" class="gwd-image-15fk gwd-image-iore"></gwd-image>
        </div>
      </gwd-page>
      <gwd-page id="page1_4" class="gwd-page-wrapper gwd-page-size gwd-lightbox" data-gwd-width="300px" data-gwd-height="250px">
        <div class="gwd-page-content gwd-page-size">
          <gwd-image source="assets/Background (1)_1.jpg" scaling="stretch" id="gwd-image_12" class="gwd-image-15fk gwd-image-iore gwd-image-19u6"></gwd-image>
        </div>
      </gwd-page>
    </gwd-pagedeck>
  </gwd-google-ad>
  <script type="text/javascript" id="gwd-init-code">
    (function() {
      var gwdAd = document.getElementById('gwd-ad');

      /**
       * Handles the DOMContentLoaded event. The DOMContentLoaded event is
       * fired when the document has been completely loaded and parsed.
       */
      function handleDomContentLoaded(event) {

      }

      /**
       * Handles the WebComponentsReady event. This event is fired when all
       * custom elements have been registered and upgraded.
       */
      function handleWebComponentsReady(event) {
        // Start the Ad lifecycle.
        requestAnimationFrame(function() {
          setTimeout(function() {
            gwdAd.initAd();
          }, 1);
        });
      }

      /**
       * Handles the event that is dispatched after the Ad has been
       * initialized and before the default page of the Ad is shown.
       */
      function handleAdInitialized(event) {}

      window.addEventListener('DOMContentLoaded',
        handleDomContentLoaded, false);
      window.addEventListener('WebComponentsReady',
        handleWebComponentsReady, false);
      window.addEventListener('adinitialized',
        handleAdInitialized, false);
    })();
    
    
    // ==========================================
// OVALTINE AI CHATBOT - POP-UP VERSION
// Banner Size: 300x250
// Background Color: #D71D07
// ==========================================

/*(function() {
  'use strict';

  // Global variables
  let selectedProduct = null;
  let conversationHistory = [];
  let isChatOpen = false;

  // Product information database
  const products = {
    'gwd-image_5': {
      name: 'Ovaltine 1.2Kg',
      description: 'Family Size Pack',
      size: '1.2kg'
    },
    'Ovaltine_18g1': {
      name: 'Ovaltine 18g',
      description: 'Single Serving Sachet',
      size: '18g'
    },
    '3in1_Ovaltine_27G1': {
      name: '3-in-1 Ovaltine 27g',
      description: 'Instant Mix with Milk',
      size: '27g'
    },
    'Ovaltine_800g1': {
      name: 'Ovaltine 800g',
      description: 'Regular Family Pack',
      size: '800g'
    }
  };

  // ==========================================
  // STEP 1: CREATE CHATBOT ICON (Smaller for 300x250)
  // ==========================================
  
  function createChatbotIcon() {
    // Check if icon already exists
    if (document.getElementById('ovaltine-chat-icon')) {
      return;
    }

    const chatIcon = document.createElement('div');
    chatIcon.id = 'ovaltine-chat-icon';
    chatIcon.innerHTML = `
      <div class="chat-icon-pulse"></div>
      <svg width="24" height="24" viewBox="0 0 32 32" fill="none">
        <path d="M16 2C8.268 2 2 7.641 2 14.5C2 18.219 3.875 21.508 6.857 23.739L5.5 29L11.343 26.196C12.834 26.711 14.388 27 16 27C23.732 27 30 21.359 30 14.5C30 7.641 23.732 2 16 2Z" fill="white"/>
        <circle cx="11" cy="14" r="1.5" fill="#D71D07"/>
        <circle cx="16" cy="14" r="1.5" fill="#D71D07"/>
        <circle cx="21" cy="14" r="1.5" fill="#D71D07"/>
      </svg>
    `;

    // Add styles - Optimized for 300x250 banner
    const style = document.createElement('style');
    style.textContent = `
      #ovaltine-chat-icon {
        position: absolute;
        bottom: 8px;
        right: 8px;
        width: 45px;
        height: 45px;
        background: #D71D07;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 3px 10px rgba(215, 29, 7, 0.5);
        z-index: 9999;
        transition: transform 0.3s ease;
      }

      #ovaltine-chat-icon:hover {
        transform: scale(1.15);
      }

      #ovaltine-chat-icon:active {
        transform: scale(0.9);
      }

      .chat-icon-pulse {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: #D71D07;
        animation: pulse 2s infinite;
        z-index: -1;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
          opacity: 1;
        }
        100% {
          transform: scale(1.4);
          opacity: 0;
        }
      }
    `;

    document.head.appendChild(style);
    document.body.appendChild(chatIcon);

    // Add click event
    chatIcon.addEventListener('click', toggleChatWindow);

    console.log('Ovaltine chat icon created! ‚úÖ');
  }

  // ==========================================
  // STEP 2: CREATE CHAT WINDOW (Optimized for 300x250)
  // ==========================================
  
  function createChatWindow() {
    // Check if window already exists
    if (document.getElementById('ovaltine-chat-window')) {
      return;
    }

    const chatWindow = document.createElement('div');
    chatWindow.id = 'ovaltine-chat-window';
    chatWindow.innerHTML = `
      <div class="chat-header">
        <div class="chat-header-content">
          <div class="chat-avatar">ü•§</div>
          <div class="chat-header-text">
            <h3>Ovaltine Chat</h3>
          </div>
        </div>
        <button class="chat-close-btn" id="chat-close-btn">‚úï</button>
      </div>

      <div class="chat-body">
        <div id="chat-messages" class="chat-messages"></div>
      </div>

      <div class="chat-quick-actions" id="chat-quick-actions">
        <button class="quick-btn" data-message="Give me creative drink recipes ü•§">ü•§</button>
        <button class="quick-btn" data-message="Show me breakfast ideas üç≥">üç≥</button>
        <button class="quick-btn" data-message="Dessert ideas üç∞">üç∞</button>
        <button class="quick-btn" data-message="For kids üë∂">üë∂</button>
      </div>

      <div class="chat-footer">
        <input 
          type="text" 
          id="chat-input" 
          class="chat-input" 
          placeholder="Ask about Ovaltine..."
          autocomplete="off"
        />
        <button class="chat-send-btn" id="chat-send-btn">
          <svg width="16" height="16" viewBox="0 0 20 20" fill="none">
            <path d="M2 10L18 2L10 18L8 11L2 10Z" fill="white" stroke="white" stroke-width="2"/>
          </svg>
        </button>
      </div>
    `;

    // Add styles - Perfect for 300x250 banner
    const style = document.createElement('style');
    style.textContent = `
      #ovaltine-chat-window {
        position: absolute;
        top: 0;
        left: 0;
        width: 300px;
        height: 250px;
        background: white;
        display: none;
        flex-direction: column;
        z-index: 10000;
        overflow: hidden;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      #ovaltine-chat-window.open {
        display: flex;
      }

      .chat-header {
        background: linear-gradient(135deg, #D71D07 0%, #FF4136 100%);
        color: white;
        padding: 8px 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        min-height: 45px;
      }

      .chat-header-content {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .chat-avatar {
        width: 28px;
        height: 28px;
        background: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
      }

      .chat-header-text h3 {
        margin: 0;
        font-size: 13px;
        font-weight: bold;
      }

      .chat-close-btn {
        background: transparent;
        border: none;
        color: white;
        font-size: 20px;
        cursor: pointer;
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: background 0.2s;
      }

      .chat-close-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .chat-body {
        flex: 1;
        overflow-y: auto;
        padding: 8px;
        background: #f5f5f5;
      }

      .chat-messages {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .chat-message {
        display: flex;
        animation: slideIn 0.3s ease;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .chat-message.bot-message {
        justify-content: flex-start;
      }

      .chat-message.user-message {
        justify-content: flex-end;
      }

      .message-bubble {
        max-width: 80%;
        padding: 7px 10px;
        border-radius: 10px;
        font-size: 11px;
        line-height: 1.3;
      }

      .bot-bubble {
        background: white;
        color: #333;
        border-bottom-left-radius: 3px;
        box-shadow: 0 1px 2px rgba(0,0,0,0.1);
      }

      .user-bubble {
        background: #D71D07;
        color: white;
        border-bottom-right-radius: 3px;
      }

      .message-bubble p {
        margin: 0;
        white-space: pre-wrap;
        word-wrap: break-word;
      }

      .typing-indicator {
        display: flex;
        gap: 3px;
        padding: 8px;
      }

      .typing-dot {
        width: 6px;
        height: 6px;
        background: #999;
        border-radius: 50%;
        animation: typing 1.4s infinite;
      }

      .typing-dot:nth-child(2) {
        animation-delay: 0.2s;
      }

      .typing-dot:nth-child(3) {
        animation-delay: 0.4s;
      }

      @keyframes typing {
        0%, 60%, 100% {
          transform: translateY(0);
        }
        30% {
          transform: translateY(-6px);
        }
      }

      .chat-quick-actions {
        padding: 6px 8px;
        background: white;
        border-top: 1px solid #e0e0e0;
        display: flex;
        gap: 5px;
        overflow-x: auto;
      }

      .quick-btn {
        background: white;
        border: 1.5px solid #D71D07;
        color: #D71D07;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 14px;
        cursor: pointer;
        white-space: nowrap;
        transition: all 0.2s;
        min-width: 32px;
      }

      .quick-btn:hover {
        background: #D71D07;
        color: white;
      }

      .chat-footer {
        padding: 8px;
        background: white;
        border-top: 1px solid #e0e0e0;
        display: flex;
        gap: 6px;
      }

      .chat-input {
        flex: 1;
        padding: 6px 10px;
        border: 1.5px solid #e0e0e0;
        border-radius: 16px;
        font-size: 11px;
        outline: none;
        transition: border-color 0.2s;
      }

      .chat-input:focus {
        border-color: #D71D07;
      }

      .chat-send-btn {
        width: 32px;
        height: 32px;
        background: #D71D07;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.2s;
        flex-shrink: 0;
      }

      .chat-send-btn:hover {
        transform: scale(1.1);
      }

      .chat-send-btn:active {
        transform: scale(0.9);
      }

     
      .chat-body::-webkit-scrollbar {
        width: 4px;
      }

      .chat-body::-webkit-scrollbar-track {
        background: #f1f1f1;
      }

      .chat-body::-webkit-scrollbar-thumb {
        background: #D71D07;
        border-radius: 2px;
      }
    `;

    document.head.appendChild(style);
    document.body.appendChild(chatWindow);

    // Setup event listeners
    setupChatEventListeners();

    console.log('Ovaltine chat window created! ‚úÖ');
  }

  // ==========================================
  // STEP 3: TOGGLE CHAT WINDOW
  // ==========================================
  
  function toggleChatWindow() {
    const chatWindow = document.getElementById('ovaltine-chat-window');
    
    if (!chatWindow) {
      createChatWindow();
      setTimeout(toggleChatWindow, 100);
      return;
    }

    isChatOpen = !isChatOpen;

    if (isChatOpen) {
      chatWindow.classList.add('open');
      
      // Send welcome message if first time opening
      const messages = document.getElementById('chat-messages');
      if (messages && messages.children.length === 0) {
        setTimeout(() => {
          sendWelcomeMessage();
        }, 300);
      }

      // Focus input
      const input = document.getElementById('chat-input');
      if (input) {
        setTimeout(() => input.focus(), 400);
      }
    } else {
      chatWindow.classList.remove('open');
    }
  }

  // ==========================================
  // STEP 4: DISPLAY FUNCTIONS
  // ==========================================
  
  function addUserMessage(message) {
    const chatContainer = document.getElementById('chat-messages');
    if (!chatContainer) return;
    
    const messageDiv = document.createElement('div');
    messageDiv.className = 'chat-message user-message';
    messageDiv.innerHTML = `
      <div class="message-bubble user-bubble">
        <p>${escapeHtml(message)}</p>
      </div>
    `;
    
    chatContainer.appendChild(messageDiv);
    scrollToBottom();
  }

  function addBotMessage(message) {
    const chatContainer = document.getElementById('chat-messages');
    if (!chatContainer) return;
    
    const messageDiv = document.createElement('div');
    messageDiv.className = 'chat-message bot-message';
    messageDiv.innerHTML = `
      <div class="message-bubble bot-bubble">
        <p>${escapeHtml(message).replace(/\n/g, '<br>')}</p>
      </div>
    `;
    
    chatContainer.appendChild(messageDiv);
    scrollToBottom();
  }

  function showTypingIndicator() {
    const chatContainer = document.getElementById('chat-messages');
    if (!chatContainer) return;
    
    const typingDiv = document.createElement('div');
    typingDiv.id = 'typing-indicator';
    typingDiv.className = 'chat-message bot-message';
    typingDiv.innerHTML = `
      <div class="message-bubble bot-bubble">
        <div class="typing-indicator">
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
        </div>
      </div>
    `;
    
    chatContainer.appendChild(typingDiv);
    scrollToBottom();
  }

  function removeTypingIndicator() {
    const typingIndicator = document.getElementById('typing-indicator');
    if (typingIndicator) {
      typingIndicator.remove();
    }
  }

  function scrollToBottom() {
    const chatContainer = document.getElementById('chat-messages');
    if (chatContainer) {
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }
  }

  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  // ==========================================
  // STEP 5: WELCOME MESSAGE
  // ==========================================
  
  function sendWelcomeMessage() {
    const productInfo = selectedProduct ? products[selectedProduct] : null;
    
    let welcomeMessage = `Hi! üëã I'm your Ovaltine assistant! ü•§\n\n`;
    
    if (productInfo) {
      welcomeMessage += `I see you're checking out ${productInfo.name}! ‚ú®\n\n`;
    }
    
    welcomeMessage += `Ask me about:\n‚Ä¢ Recipes üç≥\n‚Ä¢ Drinks ü•§\n‚Ä¢ Desserts üç∞\n‚Ä¢ Tips & tricks üí°`;
    
    addBotMessage(welcomeMessage);
  }

  // ==========================================
  // STEP 6: GOOGLE GEMINI AI INTEGRATION
  // ==========================================
  
  // üîë PUT YOUR GOOGLE GEMINI API KEY HERE üîë
  const GEMINI_API_KEY = 'AIzaSyCKeWLVhMG-8dG4r-zBG-UGpCuHrQP-JHk'; // Replace with your actual key
  
  // Try multiple model names (Google keeps changing them!)
  const GEMINI_MODELS = [
    'gemini-pro',
    'gemini-1.5-flash',
    'gemini-1.5-flash-latest',
    'gemini-1.5-pro',
    'gemini-1.0-pro',
    'gemini-1.5-pro-latest'
  ];
  
  let workingModel = null;
  let availableModels = [];
  
  // Function to list available models
  async function listAvailableModels() {
    try {
      console.log('üîç Checking available models for your API key...');
      
      // Try v1beta first
      let response = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models?key=${GEMINI_API_KEY}`
      );
      
      if (!response.ok) {
        // Try v1
        response = await fetch(
          `https://generativelanguage.googleapis.com/v1/models?key=${GEMINI_API_KEY}`
        );
      }
      
      if (response.ok) {
        const data = await response.json();
        availableModels = data.models
          .filter(m => m.supportedGenerationMethods?.includes('generateContent'))
          .map(m => m.name.replace('models/', ''));
        
        console.log('‚úÖ Available models:', availableModels);
        return availableModels;
      }
    } catch (error) {
      console.error('Error listing models:', error);
    }
    return [];
  }
  
  async function sendMessageToAI(userMessage) {
    const productInfo = selectedProduct ? products[selectedProduct] : null;
    
    // Add to conversation history
    conversationHistory.push({
      role: 'user',
      content: userMessage
    });
    
    // Build comprehensive prompt with context
    let fullPrompt = `You are an enthusiastic Ovaltine cooking assistant! ü•§ Help users discover creative and delicious ways to use Ovaltine products.

Your expertise includes:
- Creative drink recipes (hot drinks, cold drinks, smoothies, frappes, milkshakes)
- Breakfast ideas (pancakes, waffles, oatmeal, pap)
- Desserts and baking (cookies, cakes, brownies, ice cream)
- Healthy recipes and nutrition tips
- Nigerian food fusion (mixing with pap/akamu, kunu, zobo)
- Quick 5-minute recipes for busy people
- Fun ideas for kids
- Workout and energy boost drinks
- Special occasion recipes

Response style:
- Be VERY friendly and enthusiastic
- Use emojis generously ü•§‚òïüç≥üç∞üí™
- Keep responses SHORT and concise (2-4 sentences max unless giving a recipe)
- For recipes, use clear numbered steps
- Be creative and inspiring
- Give practical, easy-to-follow advice
- Consider Nigerian context and local ingredients
- Encourage trying new things

`;

    if (productInfo) {
      fullPrompt += `\nüéØ IMPORTANT: The user has selected ${productInfo.name} (${productInfo.size}). Tailor your advice to this specific product size.\n`;
      
      // Add product-specific context
      if (productInfo.size === '1.2kg') {
        fullPrompt += `Note: This is the family size - suggest recipes that serve multiple people or can be made in batches.\n`;
      } else if (productInfo.size === '18g') {
        fullPrompt += `Note: This is a single-serving sachet - perfect for on-the-go, travel, or individual portions.\n`;
      } else if (productInfo.size === '27g') {
        fullPrompt += `Note: This is the 3-in-1 instant mix (includes milk powder) - no extra milk needed, just add hot water!\n`;
      } else if (productInfo.size === '800g') {
        fullPrompt += `Note: This is the regular family pack - good for daily use and regular recipes.\n`;
      }
    }
    
    fullPrompt += `\n--- CONVERSATION HISTORY ---\n`;
    
    // Add conversation history to maintain context
    conversationHistory.forEach(msg => {
      if (msg.role === 'user') {
        fullPrompt += `User: ${msg.content}\n`;
      } else if (msg.role === 'assistant') {
        fullPrompt += `Assistant: ${msg.content}\n`;
      }
    });
    
    fullPrompt += `\nPlease respond to the user's latest message. Remember to be brief, friendly, and use emojis! üéâ`;

    // Function to try a specific model
    async function tryModel(modelName, apiVersion = 'v1beta') {
      try {
        console.log(`Trying model: ${modelName} with API version: ${apiVersion}`);
        
        const response = await fetch(
          `https://generativelanguage.googleapis.com/${apiVersion}/models/${modelName}:generateContent?key=${GEMINI_API_KEY}`,
          {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              contents: [{
                parts: [{
                  text: fullPrompt
                }]
              }],
              generationConfig: {
                temperature: 0.9,
                topK: 40,
                topP: 0.95,
                maxOutputTokens: 500,
              }
            })
          }
        );

        if (!response.ok) {
          const errorData = await response.json();
          console.log(`Model ${modelName} failed:`, errorData.error?.message);
          return null;
        }

        const data = await response.json();
        
        // Extract the AI response
        if (data.candidates && data.candidates[0] && data.candidates[0].content) {
          console.log(`‚úÖ Success with model: ${modelName}`);
          workingModel = modelName; // Save for next time
          return data.candidates[0].content.parts[0].text.trim();
        }
        
        return null;
        
      } catch (error) {
        console.log(`Model ${modelName} error:`, error.message);
        return null;
      }
    }

    try {
      console.log('Sending request to Google Gemini...');
      
      let aiResponse = null;
      
      // First, check available models if we haven't already
      if (availableModels.length === 0 && !workingModel) {
        await listAvailableModels();
      }
      
      // If we found available models, use them instead
      const modelsToTry = availableModels.length > 0 ? availableModels : GEMINI_MODELS;
      
      // If we already found a working model, use it
      if (workingModel) {
        aiResponse = await tryModel(workingModel);
      }
      
      // If not, try all models until one works
      if (!aiResponse) {
        for (const model of modelsToTry) {
          aiResponse = await tryModel(model);
          if (aiResponse) break;
          
          // Also try with v1 API version
          aiResponse = await tryModel(model, 'v1');
          if (aiResponse) break;
        }
      }
      
      if (!aiResponse) {
        return "‚ö†Ô∏è Could not connect to Gemini AI. Available models: " + 
               (availableModels.length > 0 ? availableModels.join(', ') : 'None found') +
               "\n\nPlease verify:\n1. Your API key is correct\n2. The Generative Language API is enabled\n3. You have billing set up (free tier is OK)\n\nGet your key at: https://aistudio.google.com/app/apikey";
      }
      
      // Add to conversation history
      conversationHistory.push({
        role: 'assistant',
        content: aiResponse
      });
      
      return aiResponse;
      
    } catch (error) {
      console.error('AI Error:', error);
      
      // Helpful error messages
      if (error.message.includes('API key')) {
        return "‚ö†Ô∏è Please check your Google Gemini API key. Make sure it's from Google AI Studio (https://aistudio.google.com/app/apikey) and has the Generative Language API enabled.";
      }
      
      return "Sorry, I'm having trouble connecting right now. Please check the console (F12) for details and verify your API key. üòä";
    }
  }

  // ==========================================
  // STEP 7: EVENT LISTENERS
  // ==========================================
  
  function setupChatEventListeners() {
    // Close button
    const closeBtn = document.getElementById('chat-close-btn');
    if (closeBtn) {
      closeBtn.addEventListener('click', toggleChatWindow);
    }

    // Send button
    const sendButton = document.getElementById('chat-send-btn');
    if (sendButton) {
      sendButton.addEventListener('click', handleSendMessage);
    }
    
    // Input field (Enter key)
    const inputField = document.getElementById('chat-input');
    if (inputField) {
      inputField.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          handleSendMessage();
        }
      });
    }
    
    // Quick action buttons
    const quickButtons = document.querySelectorAll('.quick-btn');
    quickButtons.forEach(btn => {
      btn.addEventListener('click', function() {
        const message = this.getAttribute('data-message');
        handleQuickAction(message);
      });
    });
  }

  async function handleSendMessage() {
    const inputField = document.getElementById('chat-input');
    if (!inputField) return;
    
    const message = inputField.value.trim();
    if (!message) return;
    
    // Clear input
    inputField.value = '';
    
    // Display user message
    addUserMessage(message);
    
    // Show typing indicator
    showTypingIndicator();
    
    // Get AI response
    const aiResponse = await sendMessageToAI(message);
    
    // Remove typing indicator
    removeTypingIndicator();
    
    // Display AI response
    addBotMessage(aiResponse);
  }

  async function handleQuickAction(message) {
    // Display user message
    addUserMessage(message);
    
    // Show typing indicator
    showTypingIndicator();
    
    // Get AI response
    const aiResponse = await sendMessageToAI(message);
    
    // Remove typing indicator
    removeTypingIndicator();
    
    // Display AI response
    addBotMessage(aiResponse);
  }

  // ==========================================
  // STEP 8: PRODUCT SELECTION TRACKING
  // ==========================================
  
  // Map pages to products
  const pageToProduct = {
    'page1_1': 'gwd-image_5',        // 1.2Kg
    'page1_2': 'Ovaltine_18g1',      // 18g Sachet
    'page1_3': '3in1_Ovaltine_27G1', // 3-in-1 27g
    'page1_4': 'Ovaltine_800g1'      // 800g
  };
  
  // Function to set selected product based on current page
  function setProductFromPage(pageId) {
    if (pageToProduct[pageId]) {
      selectedProduct = pageToProduct[pageId];
      sessionStorage.setItem('selectedOvaltineProduct', selectedProduct);
      console.log('Current page:', pageId, '‚Üí Product:', products[selectedProduct].name);
      
      // Reset conversation when switching products
      if (conversationHistory.length > 0) {
        conversationHistory = [];
        const messages = document.getElementById('chat-messages');
        if (messages) {
          messages.innerHTML = '';
        }
      }
    }
  }
  
  // Function to manually set selected product (if needed)
  window.setOvaltineProduct = function(productId) {
    selectedProduct = productId;
    sessionStorage.setItem('selectedOvaltineProduct', productId);
    console.log('Manually selected product:', productId, products[productId]);
  };

  // Check for previously selected product
  function checkSelectedProduct() {
    const stored = sessionStorage.getItem('selectedOvaltineProduct');
    if (stored && products[stored]) {
      selectedProduct = stored;
    }
  }

  // Detect current page and set product
  function detectCurrentPage() {
    // Method 1: Check visible page
    const pages = ['page1_1', 'page1_2', 'page1_3', 'page1_4'];
    
    pages.forEach(pageId => {
      const pageElement = document.getElementById(pageId);
      if (pageElement) {
        const style = window.getComputedStyle(pageElement);
        if (style.display !== 'none' && style.visibility !== 'hidden') {
          setProductFromPage(pageId);
        }
      }
    });
    
    // Method 2: Use GWD API if available
    if (window.gwd && window.gwd.api && window.gwd.api.getCurrentPage) {
      const currentPage = window.gwd.api.getCurrentPage();
      if (currentPage) {
        setProductFromPage(currentPage);
      }
    }
  }

  // ==========================================
  // STEP 9: INITIALIZATION
  // ==========================================
  
  function initialize() {
    console.log('Initializing Ovaltine Chatbot...');
    
    // Check for selected product
    checkSelectedProduct();
    
    // Detect current page
    detectCurrentPage();
    
    // Create chatbot icon
    setTimeout(() => {
      createChatbotIcon();
    }, 1000); // Wait 1 second before showing icon
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initialize);
  } else {
    initialize();
  }

  // ==========================================
  // STEP 10: LISTEN FOR PAGE CHANGES IN GWD
  // ==========================================
  
  // Listen for GWD page changes
  document.addEventListener('DOMContentLoaded', function() {
    if (window.gwd && window.gwd.pagedeck) {
      window.gwd.pagedeck.addEventListener('pagechange', function() {
        console.log('Page changed, detecting product...');
        setTimeout(detectCurrentPage, 100);
      });
    }
  });

  // Also use MutationObserver to catch page visibility changes
  const observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
      if (mutation.type === 'attributes' && 
          (mutation.attributeName === 'style' || mutation.attributeName === 'class')) {
        detectCurrentPage();
      }
    });
  });

  // Start observing after a short delay
  setTimeout(function() {
    const pagedeck = document.querySelector('[data-gwd-group="pagedeck"]');
    if (pagedeck) {
      observer.observe(pagedeck, {
        attributes: true,
        subtree: true,
        attributeFilter: ['style', 'class']
      });
      console.log('Page observer started');
    }
  }, 1000);

  // ==========================================
  // EXPOSE FUNCTIONS GLOBALLY
  // ==========================================
  
  window.ovaltineChat = {
    open: toggleChatWindow,
    setProduct: window.setOvaltineProduct,
    reset: function() {
      conversationHistory = [];
      const messages = document.getElementById('chat-messages');
      if (messages) messages.innerHTML = '';
    }
  };

  console.log('Ovaltine Chatbot Script Loaded! ‚úÖ');

})();*/
    
    
    
    (function() {
  'use strict';

  // Global variables
  let selectedProduct = null;
  let conversationHistory = [];
  let isChatOpen = false;

  // Product information database
  const products = {
    'gwd-image_5': {
      name: 'Ovaltine 1.2Kg',
      description: 'Family Size Pack',
      size: '1.2kg'
    },
    'Ovaltine_18g1': {
      name: 'Ovaltine 18g',
      description: 'Single Serving Sachet',
      size: '18g'
    },
    '3in1_Ovaltine_27G1': {
      name: '3-in-1 Ovaltine 27g',
      description: 'Instant Mix with Milk',
      size: '27g'
    },
    'Ovaltine_800g1': {
      name: 'Ovaltine 800g',
      description: 'Regular Family Pack',
      size: '800g'
    }
  };

  // ==========================================
  // STEP 1: CREATE CHATBOT ICON
  // ==========================================
  
  function createChatbotIcon() {
    // Check if icon already exists
    if (document.getElementById('ovaltine-chat-icon')) {
      return;
    }

    const chatIcon = document.createElement('div');
    chatIcon.id = 'ovaltine-chat-icon';
    chatIcon.innerHTML = `
      <div class="chat-icon-pulse"></div>
      <svg width="24" height="24" viewBox="0 0 32 32" fill="none">
        <path d="M16 2C8.268 2 2 7.641 2 14.5C2 18.219 3.875 21.508 6.857 23.739L5.5 29L11.343 26.196C12.834 26.711 14.388 27 16 27C23.732 27 30 21.359 30 14.5C30 7.641 23.732 2 16 2Z" fill="white"/>
        <circle cx="11" cy="14" r="1.5" fill="#D71D07"/>
        <circle cx="16" cy="14" r="1.5" fill="#D71D07"/>
        <circle cx="21" cy="14" r="1.5" fill="#D71D07"/>
      </svg>
    `;

    // Add styles - Optimized for 300x250 banner
    const style = document.createElement('style');
    style.textContent = `
      #ovaltine-chat-icon {
        position: absolute;
        bottom: 8px;
        right: 8px;
        width: 45px;
        height: 45px;
        background: #D71D07;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 3px 10px rgba(215, 29, 7, 0.5);
        z-index: 9999;
        transition: transform 0.3s ease;
      }

      #ovaltine-chat-icon:hover {
        transform: scale(1.15);
      }

      #ovaltine-chat-icon:active {
        transform: scale(0.9);
      }

      .chat-icon-pulse {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: #D71D07;
        animation: pulse 2s infinite;
        z-index: -1;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
          opacity: 1;
        }
        100% {
          transform: scale(1.4);
          opacity: 0;
        }
      }
    `;

    document.head.appendChild(style);
    document.body.appendChild(chatIcon);

    // Add click event
    chatIcon.addEventListener('click', toggleChatWindow);

    console.log('Ovaltine chat icon created! ‚úÖ');
  }

  // ==========================================
  // STEP 2: CREATE CHAT WINDOW
  // ==========================================
  
  function createChatWindow() {
    // Check if window already exists
    if (document.getElementById('ovaltine-chat-window')) {
      return;
    }

    const chatWindow = document.createElement('div');
    chatWindow.id = 'ovaltine-chat-window';
    chatWindow.innerHTML = `
      <div class="chat-header">
        <div class="chat-header-content">
          <div class="chat-avatar">ü•§</div>
          <div class="chat-header-text">
            <h3>Ovaltine Chat</h3>
          </div>
        </div>
        <button class="chat-close-btn" id="chat-close-btn">‚úï</button>
      </div>

      <div class="chat-body">
        <div id="chat-messages" class="chat-messages"></div>
      </div>

      <div class="chat-quick-actions" id="chat-quick-actions">
        <button class="quick-btn" data-message="Give me creative drink recipes ü•§">ü•§</button>
        <button class="quick-btn" data-message="Show me breakfast ideas üç≥">üç≥</button>
        <button class="quick-btn" data-message="Dessert ideas üç∞">üç∞</button>
        <button class="quick-btn" data-message="For kids üë∂">üë∂</button>
      </div>

      <div class="chat-footer">
        <input 
          type="text" 
          id="chat-input" 
          class="chat-input" 
          placeholder="Ask about Ovaltine..."
          autocomplete="off"
        />
        <button class="chat-send-btn" id="chat-send-btn">
          <svg width="16" height="16" viewBox="0 0 20 20" fill="none">
            <path d="M2 10L18 2L10 18L8 11L2 10Z" fill="white" stroke="white" stroke-width="2"/>
          </svg>
        </button>
      </div>
    `;

    // Add styles - Perfect for 300x250 banner
    const style = document.createElement('style');
    style.textContent = `
      #ovaltine-chat-window {
        position: absolute;
        top: 0;
        left: 0;
        width: 300px;
        height: 250px;
        background: white;
        display: none;
        flex-direction: column;
        z-index: 10000;
        overflow: hidden;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      #ovaltine-chat-window.open {
        display: flex;
      }

      .chat-header {
        background: linear-gradient(135deg, #D71D07 0%, #FF4136 100%);
        color: white;
        padding: 8px 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        min-height: 45px;
      }

      .chat-header-content {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .chat-avatar {
        width: 28px;
        height: 28px;
        background: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
      }

      .chat-header-text h3 {
        margin: 0;
        font-size: 13px;
        font-weight: bold;
      }

      .chat-close-btn {
        background: transparent;
        border: none;
        color: white;
        font-size: 20px;
        cursor: pointer;
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        transition: background 0.2s;
      }

      .chat-close-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .chat-body {
        flex: 1;
        overflow-y: auto;
        padding: 8px;
        background: #f5f5f5;
      }

      .chat-messages {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .chat-message {
        display: flex;
        animation: slideIn 0.3s ease;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .chat-message.bot-message {
        justify-content: flex-start;
      }

      .chat-message.user-message {
        justify-content: flex-end;
      }

      .message-bubble {
        max-width: 80%;
        padding: 7px 10px;
        border-radius: 10px;
        font-size: 11px;
        line-height: 1.3;
      }

      .bot-bubble {
        background: white;
        color: #333;
        border-bottom-left-radius: 3px;
        box-shadow: 0 1px 2px rgba(0,0,0,0.1);
      }

      .user-bubble {
        background: #D71D07;
        color: white;
        border-bottom-right-radius: 3px;
      }

      .message-bubble p {
        margin: 0;
        white-space: pre-wrap;
        word-wrap: break-word;
      }

      .typing-indicator {
        display: flex;
        gap: 3px;
        padding: 8px;
      }

      .typing-dot {
        width: 6px;
        height: 6px;
        background: #999;
        border-radius: 50%;
        animation: typing 1.4s infinite;
      }

      .typing-dot:nth-child(2) {
        animation-delay: 0.2s;
      }

      .typing-dot:nth-child(3) {
        animation-delay: 0.4s;
      }

      @keyframes typing {
        0%, 60%, 100% {
          transform: translateY(0);
        }
        30% {
          transform: translateY(-6px);
        }
      }

      .chat-quick-actions {
        padding: 6px 8px;
        background: white;
        border-top: 1px solid #e0e0e0;
        display: flex;
        gap: 5px;
        overflow-x: auto;
      }

      .quick-btn {
        background: white;
        border: 1.5px solid #D71D07;
        color: #D71D07;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 14px;
        cursor: pointer;
        white-space: nowrap;
        transition: all 0.2s;
        min-width: 32px;
      }

      .quick-btn:hover {
        background: #D71D07;
        color: white;
      }

      .chat-footer {
        padding: 8px;
        background: white;
        border-top: 1px solid #e0e0e0;
        display: flex;
        gap: 6px;
      }

      .chat-input {
        flex: 1;
        padding: 6px 10px;
        border: 1.5px solid #e0e0e0;
        border-radius: 16px;
        font-size: 11px;
        outline: none;
        transition: border-color 0.2s;
      }

      .chat-input:focus {
        border-color: #D71D07;
      }

      .chat-send-btn {
        width: 32px;
        height: 32px;
        background: #D71D07;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.2s;
        flex-shrink: 0;
      }

      .chat-send-btn:hover {
        transform: scale(1.1);
      }

      .chat-send-btn:active {
        transform: scale(0.9);
      }

      .chat-body::-webkit-scrollbar {
        width: 4px;
      }

      .chat-body::-webkit-scrollbar-track {
        background: #f1f1f1;
      }

      .chat-body::-webkit-scrollbar-thumb {
        background: #D71D07;
        border-radius: 2px;
      }
    `;

    document.head.appendChild(style);
    document.body.appendChild(chatWindow);

    // Setup event listeners
    setupChatEventListeners();

    console.log('Ovaltine chat window created! ‚úÖ');
  }

  // ==========================================
  // STEP 3: TOGGLE CHAT WINDOW
  // ==========================================
  
  function toggleChatWindow() {
    const chatWindow = document.getElementById('ovaltine-chat-window');
    
    if (!chatWindow) {
      createChatWindow();
      setTimeout(toggleChatWindow, 100);
      return;
    }

    isChatOpen = !isChatOpen;

    if (isChatOpen) {
      chatWindow.classList.add('open');
      
      // Send welcome message if first time opening
      const messages = document.getElementById('chat-messages');
      if (messages && messages.children.length === 0) {
        setTimeout(() => {
          sendWelcomeMessage();
        }, 300);
      }

      // Focus input
      const input = document.getElementById('chat-input');
      if (input) {
        setTimeout(() => input.focus(), 400);
      }
    } else {
      chatWindow.classList.remove('open');
    }
  }

  // ==========================================
  // STEP 4: DISPLAY FUNCTIONS
  // ==========================================
  
  function addUserMessage(message) {
    const chatContainer = document.getElementById('chat-messages');
    if (!chatContainer) return;
    
    const messageDiv = document.createElement('div');
    messageDiv.className = 'chat-message user-message';
    messageDiv.innerHTML = `
      <div class="message-bubble user-bubble">
        <p>${escapeHtml(message)}</p>
      </div>
    `;
    
    chatContainer.appendChild(messageDiv);
    scrollToBottom();
  }

  function addBotMessage(message) {
    const chatContainer = document.getElementById('chat-messages');
    if (!chatContainer) return;
    
    const messageDiv = document.createElement('div');
    messageDiv.className = 'chat-message bot-message';
    messageDiv.innerHTML = `
      <div class="message-bubble bot-bubble">
        <p>${escapeHtml(message).replace(/\n/g, '<br>')}</p>
      </div>
    `;
    
    chatContainer.appendChild(messageDiv);
    scrollToBottom();
  }

  function showTypingIndicator() {
    const chatContainer = document.getElementById('chat-messages');
    if (!chatContainer) return;
    
    const typingDiv = document.createElement('div');
    typingDiv.id = 'typing-indicator';
    typingDiv.className = 'chat-message bot-message';
    typingDiv.innerHTML = `
      <div class="message-bubble bot-bubble">
        <div class="typing-indicator">
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
        </div>
      </div>
    `;
    
    chatContainer.appendChild(typingDiv);
    scrollToBottom();
  }

  function removeTypingIndicator() {
    const typingIndicator = document.getElementById('typing-indicator');
    if (typingIndicator) {
      typingIndicator.remove();
    }
  }

  function scrollToBottom() {
    const chatContainer = document.getElementById('chat-messages');
    if (chatContainer) {
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }
  }

  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  // ==========================================
  // STEP 5: WELCOME MESSAGE
  // ==========================================
  
  function sendWelcomeMessage() {
    const productInfo = selectedProduct ? products[selectedProduct] : null;
    
    let welcomeMessage = `Hi! üëã I'm your Ovaltine assistant! ü•§\n\n`;
    
    if (productInfo) {
      welcomeMessage += `I see you're checking out ${productInfo.name}! ‚ú®\n\n`;
    }
    
    welcomeMessage += `Ask me about:\n‚Ä¢ Recipes üç≥\n‚Ä¢ Drinks ü•§\n‚Ä¢ Desserts üç∞\n‚Ä¢ Tips & tricks üí°`;
    
    addBotMessage(welcomeMessage);
  }

  // ==========================================
  // STEP 6: GOOGLE GEMINI AI INTEGRATION
  // ==========================================
  
  // üîë PUT YOUR GOOGLE GEMINI API KEY HERE üîë
  const GEMINI_API_KEY = 'AIzaSyCKeWLVhMG-8dG4r-zBG-UGpCuHrQP-JHk'; // Replace with your actual key
  
  // Try multiple model names (Google keeps changing them!)
  const GEMINI_MODELS = [
    'gemini-pro',
    'gemini-1.5-flash',
    'gemini-1.5-flash-latest',
    'gemini-1.5-pro',
    'gemini-1.0-pro',
    'gemini-1.5-pro-latest'
  ];
  
  let workingModel = null;
  let availableModels = [];
  
  // Function to list available models
  async function listAvailableModels() {
    try {
      console.log('üîç Checking available models for your API key...');
      
      // Try v1beta first
      let response = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models?key=${GEMINI_API_KEY}`
      );
      
      if (!response.ok) {
        // Try v1
        response = await fetch(
          `https://generativelanguage.googleapis.com/v1/models?key=${GEMINI_API_KEY}`
        );
      }
      
      if (response.ok) {
        const data = await response.json();
        availableModels = data.models
          .filter(m => m.supportedGenerationMethods?.includes('generateContent'))
          .map(m => m.name.replace('models/', ''));
        
        console.log('‚úÖ Available models:', availableModels);
        return availableModels;
      }
    } catch (error) {
      console.error('Error listing models:', error);
    }
    return [];
  }
  
  async function sendMessageToAI(userMessage) {
    const productInfo = selectedProduct ? products[selectedProduct] : null;
    
    // Add to conversation history
    conversationHistory.push({
      role: 'user',
      content: userMessage
    });
    
    // Build comprehensive prompt with context
    let fullPrompt = `You are an enthusiastic Ovaltine cooking assistant! ü•§ Help users discover creative and delicious ways to use Ovaltine products.

Your expertise includes:
- Creative drink recipes (hot drinks, cold drinks, smoothies, frappes, milkshakes)
- Breakfast ideas (pancakes, waffles, oatmeal, pap)
- Desserts and baking (cookies, cakes, brownies, ice cream)
- Healthy recipes and nutrition tips
- Nigerian food fusion (mixing with pap/akamu, kunu, zobo)
- Quick 5-minute recipes for busy people
- Fun ideas for kids
- Workout and energy boost drinks
- Special occasion recipes

Response style:
- Be VERY friendly and enthusiastic
- Use emojis generously ü•§‚òïüç≥üç∞üí™
- Keep responses SHORT and concise (2-4 sentences max unless giving a recipe)
- For recipes, use clear numbered steps
- Be creative and inspiring
- Give practical, easy-to-follow advice
- Consider Nigerian context and local ingredients
- Encourage trying new things

`;

    if (productInfo) {
      fullPrompt += `\nüéØ IMPORTANT: The user has selected ${productInfo.name} (${productInfo.size}). Tailor your advice to this specific product size.\n`;
      
      // Add product-specific context
      if (productInfo.size === '1.2kg') {
        fullPrompt += `Note: This is the family size - suggest recipes that serve multiple people or can be made in batches.\n`;
      } else if (productInfo.size === '18g') {
        fullPrompt += `Note: This is a single-serving sachet - perfect for on-the-go, travel, or individual portions.\n`;
      } else if (productInfo.size === '27g') {
        fullPrompt += `Note: This is the 3-in-1 instant mix (includes milk powder) - no extra milk needed, just add hot water!\n`;
      } else if (productInfo.size === '800g') {
        fullPrompt += `Note: This is the regular family pack - good for daily use and regular recipes.\n`;
      }
    }
    
    fullPrompt += `\n--- CONVERSATION HISTORY ---\n`;
    
    // Add conversation history to maintain context
    conversationHistory.forEach(msg => {
      if (msg.role === 'user') {
        fullPrompt += `User: ${msg.content}\n`;
      } else if (msg.role === 'assistant') {
        fullPrompt += `Assistant: ${msg.content}\n`;
      }
    });
    
    fullPrompt += `\nPlease respond to the user's latest message. Remember to be brief, friendly, and use emojis! üéâ`;

    // Function to try a specific model
    async function tryModel(modelName, apiVersion = 'v1beta') {
      try {
        console.log(`Trying model: ${modelName} with API version: ${apiVersion}`);
        
        const response = await fetch(
          `https://generativelanguage.googleapis.com/${apiVersion}/models/${modelName}:generateContent?key=${GEMINI_API_KEY}`,
          {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              contents: [{
                parts: [{
                  text: fullPrompt
                }]
              }],
              generationConfig: {
                temperature: 0.9,
                topK: 40,
                topP: 0.95,
                maxOutputTokens: 500,
              }
            })
          }
        );

        if (!response.ok) {
          const errorData = await response.json();
          console.log(`Model ${modelName} failed:`, errorData.error?.message);
          return null;
        }

        const data = await response.json();
        
        // Extract the AI response
        if (data.candidates && data.candidates[0] && data.candidates[0].content) {
          console.log(`‚úÖ Success with model: ${modelName}`);
          workingModel = modelName; // Save for next time
          return data.candidates[0].content.parts[0].text.trim();
        }
        
        return null;
        
      } catch (error) {
        console.log(`Model ${modelName} error:`, error.message);
        return null;
      }
    }

    try {
      console.log('Sending request to Google Gemini...');
      
      let aiResponse = null;
      
      // First, check available models if we haven't already
      if (availableModels.length === 0 && !workingModel) {
        await listAvailableModels();
      }
      
      // If we found available models, use them instead
      const modelsToTry = availableModels.length > 0 ? availableModels : GEMINI_MODELS;
      
      // If we already found a working model, use it
      if (workingModel) {
        aiResponse = await tryModel(workingModel);
      }
      
      // If not, try all models until one works
      if (!aiResponse) {
        for (const model of modelsToTry) {
          aiResponse = await tryModel(model);
          if (aiResponse) break;
          
          // Also try with v1 API version
          aiResponse = await tryModel(model, 'v1');
          if (aiResponse) break;
        }
      }
      
      if (!aiResponse) {
        return "‚ö†Ô∏è Could not connect to Gemini AI. Available models: " + 
               (availableModels.length > 0 ? availableModels.join(', ') : 'None found') +
               "\n\nPlease verify:\n1. Your API key is correct\n2. The Generative Language API is enabled\n3. You have billing set up (free tier is OK)\n\nGet your key at: https://aistudio.google.com/app/apikey";
      }
      
      // Add to conversation history
      conversationHistory.push({
        role: 'assistant',
        content: aiResponse
      });
      
      return aiResponse;
      
    } catch (error) {
      console.error('AI Error:', error);
      
      // Helpful error messages
      if (error.message.includes('API key')) {
        return "‚ö†Ô∏è Please check your Google Gemini API key. Make sure it's from Google AI Studio (https://aistudio.google.com/app/apikey) and has the Generative Language API enabled.";
      }
      
      return "Sorry, I'm having trouble connecting right now. Please check the console (F12) for details and verify your API key. üòä";
    }
  }

  // ==========================================
  // STEP 7: EVENT LISTENERS
  // ==========================================
  
  function setupChatEventListeners() {
    // Close button
    const closeBtn = document.getElementById('chat-close-btn');
    if (closeBtn) {
      closeBtn.addEventListener('click', toggleChatWindow);
    }

    // Send button
    const sendButton = document.getElementById('chat-send-btn');
    if (sendButton) {
      sendButton.addEventListener('click', handleSendMessage);
    }
    
    // Input field (Enter key)
    const inputField = document.getElementById('chat-input');
    if (inputField) {
      inputField.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          handleSendMessage();
        }
      });
    }
    
    // Quick action buttons
    const quickButtons = document.querySelectorAll('.quick-btn');
    quickButtons.forEach(btn => {
      btn.addEventListener('click', function() {
        const message = this.getAttribute('data-message');
        handleQuickAction(message);
      });
    });
  }

  async function handleSendMessage() {
    const inputField = document.getElementById('chat-input');
    if (!inputField) return;
    
    const message = inputField.value.trim();
    if (!message) return;
    
    // Clear input
    inputField.value = '';
    
    // Display user message
    addUserMessage(message);
    
    // Show typing indicator
    showTypingIndicator();
    
    // Get AI response
    const aiResponse = await sendMessageToAI(message);
    
    // Remove typing indicator
    removeTypingIndicator();
    
    // Display AI response
    addBotMessage(aiResponse);
  }

  async function handleQuickAction(message) {
    // Display user message
    addUserMessage(message);
    
    // Show typing indicator
    showTypingIndicator();
    
    // Get AI response
    const aiResponse = await sendMessageToAI(message);
    
    // Remove typing indicator
    removeTypingIndicator();
    
    // Display AI response
    addBotMessage(aiResponse);
  }

  // ==========================================
  // STEP 8: DETECT PAGE 1 AND HIDE CHATBOT
  // ==========================================
  
  function checkIfOnPage1() {
    // Look for the specific background image element that indicates page 1
    const page1Background = document.getElementById('gwd-image_4');
    
    if (page1Background) {
      const style = window.getComputedStyle(page1Background);
      const isVisible = style.display !== 'none' && 
                       style.visibility !== 'hidden' &&
                       style.opacity !== '0';
      
      console.log('Page 1 background detected. Visible:', isVisible);
      return isVisible;
    }
    
    return false;
  }

  function updateChatbotVisibility() {
    const chatIcon = document.getElementById('ovaltine-chat-icon');
    const chatWindow = document.getElementById('ovaltine-chat-window');
    
    if (checkIfOnPage1()) {
      // Hide chatbot on page 1
      if (chatIcon) chatIcon.style.display = 'none';
      if (chatWindow && chatWindow.classList.contains('open')) {
        chatWindow.classList.remove('open');
      }
      console.log('‚ùå Chatbot hidden (on page 1)');
    } else {
      // Show chatbot on all other pages
      if (chatIcon) chatIcon.style.display = 'flex';
      console.log('‚úÖ Chatbot visible (not on page 1)');
    }
  }

  // ==========================================
  // STEP 9: INITIALIZATION
  // ==========================================
  
  function initialize() {
    console.log('Initializing Ovaltine Chatbot...');
    
    // Create chatbot elements
    createChatbotIcon();
    createChatWindow();
    
    // Check visibility based on current page
    updateChatbotVisibility();
    
    console.log('Chatbot initialized! Will be hidden only on page 1.');
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initialize);
  } else {
    initialize();
  }

  // ==========================================
  // STEP 10: MONITOR FOR PAGE CHANGES
  // ==========================================
  
  // Use MutationObserver to detect when page 1 background appears/disappears
  const observer = new MutationObserver(function(mutations) {
    let shouldUpdate = false;
    
    mutations.forEach(function(mutation) {
      if (mutation.type === 'attributes') {
        // Check if the page 1 background element's visibility changed
        if (mutation.target.id === 'gwd-image_4') {
          shouldUpdate = true;
        }
      }
      
      // Also check for any style changes in the parent containers
      if (mutation.type === 'attributes' && 
          (mutation.attributeName === 'style' || mutation.attributeName === 'class')) {
        if (mutation.target.querySelector && mutation.target.querySelector('#gwd-image_4')) {
          shouldUpdate = true;
        }
      }
    });
    
    if (shouldUpdate) {
      setTimeout(updateChatbotVisibility, 50);
    }
  });

  // Start observing
  setTimeout(function() {
    observer.observe(document.body, {
      attributes: true,
      subtree: true,
      attributeFilter: ['style', 'class']
    });
    console.log('Page change observer started');
  }, 1000);

  // Also check periodically in case observer misses changes
  setInterval(updateChatbotVisibility, 1000);

  // ==========================================
  // EXPOSE FUNCTIONS GLOBALLY
  // ==========================================
  
  window.ovaltineChat = {
    open: toggleChatWindow,
    setProduct: function(productId) {
      selectedProduct = productId;
      sessionStorage.setItem('selectedOvaltineProduct', productId);
    },
    reset: function() {
      conversationHistory = [];
      const messages = document.getElementById('chat-messages');
      if (messages) messages.innerHTML = '';
    },
    forceShow: function() {
      const chatIcon = document.getElementById('ovaltine-chat-icon');
      if (chatIcon) chatIcon.style.display = 'flex';
    },
    forceHide: function() {
      const chatIcon = document.getElementById('ovaltine-chat-icon');
      if (chatIcon) chatIcon.style.display = 'none';
    }
  };

  console.log('Ovaltine Chatbot Script Loaded! ‚úÖ');

})();
    
    
    
  
    
  </script>
</body>

</html>